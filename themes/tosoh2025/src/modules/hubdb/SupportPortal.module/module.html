{% set filter_columns = module.filters|map('hubdb_column_id')|join(',') %}
{% set access_level = module.access_level or "customer" %}
{% set breadcrumbs = module.breadcrumbs %}


{% set search_title = module.search.title %}
{% set search_hubdb_table = module.search.hubdb_table_id %}
{% set search_hubdb_column = module.search.hubdb_column_id %}
{% set search_is_access_level_filter_enabled = module.search.is_access_level_filter_enabled %}

{%set title = module.title %}
{%set description = module.description %}

{% set row = dynamic_page_hubdb_row %}

{% require_js position="head" %}
<script>
const accessLevel = '{{ access_level }}'
const filters = '{{ filter_columns }}';
const title = '{{title}}'
const description = '{{description}}'
const search = {
    title: "{{ search_title  || ""}}",
    hubdb_table_id: "{{ search_hubdb_table || ""}}",
    is_access_level_filter_enabled: {{search_is_access_level_filter_enabled}},
    hubdb_column_id: "{{ search_hubdb_column || ""}}",
};
window.Tosoh.SupportPortalContent = { filters, search, title, description, accessLevel };
</script>
{% end_require_js %}


{% if dynamic_page_hubdb_row %}
    {% set wistia_video_id = row.wistia_cached_url|split('/')|reverse|first %}
    {% set wistia_video_url = row.wistia_video_url %}

        {% require_js %}
        <script>
          window._wq = window._wq || [];
          _wq.push({
            id: "{{ wistia_video_id }}",
            options: {
              playerColor: "ed1a3b",
              backgroundOpacity: 1,
            }
          });
        </script>
        <script charset="ISO-8859-1" src="//fast.wistia.com/assets/external/E-v1.js" async></script>
        {% end_require_js %}
      
        <div class='p-md md:pl-xl md:pr-xl mt-[6rem] mb-[6rem]'>
         <div class="w-full bg-ghost-white gap-xs p-md max-w-max-page rounded-lg mx-auto divide-x divide-x-default">
            <a class="whitespace-nowrap" href="/support-portal">Support Portal </a>
            <span class='break-all ml-2xs'>{{ row.name }}</span>
          </div>
          <div class="flex pt-md flex-col gap-md mx-auto max-w-max-page">
            <h1 class="text-xl font-bold break-all">{{ row.name }}</h1>
            <div class="w-full max-w-[64rem] m-auto rounded-lg overflow-hidden aspect-video wistia_responsive_padding wistia_embed wistia_async_{{ wistia_video_id }}"></div>    
            <div class="flex flex-col gap mb-lg">
              {% if module.display_video_download && wistia_video_url %}
              <a href="{{wistia_video_url}}" class="button mx-auto">Download</a>
              {% endif %}
          </div>      
          </div>
        </div>
        </div>
{% else %}
  <div class="mt-32"></div>
  {%- if breadcrumbs|length > 0 -%}
    <div class="gap-base max-w-max-page p-md md:pl-2xl md:pr-2xl m-auto flex items-center">
      {%- for breadcrumb in breadcrumbs %}
  
        {% if !loop.last %}
          <a href="{{ breadcrumb.url.href }}" class="text-nickel cursor-pointer text-2xl">
            {{ breadcrumb.title }}
          </a>
          <div class="text-nickel max-h-[1.1875rem] max-w-[0.675rem]">
            <svg
              class="max-h-inherit max-w-inherit"
              xmlns="http://www.w3.org/2000/svg"
              width="100%"
              height="100%"
              viewBox="0 0 11 19"
              fill="none">
              <path d="M1.55 0L0 1.55L7.95 9.5L0 17.45L1.55 19L11 9.5L1.55 0Z" fill="currentColor" />
            </svg>
          </div>
        {% endif %}
  
        {% if loop.last %}
          <a href="{{ breadcrumb.url.href }}" class=" cursor-pointer text-default font-bold text-2xl">
            {{ breadcrumb.title }}
          </a>
        {% endif %}
      {%- endfor -%}
    </div>
  {%- endif -%}

<tosoh-support-portal></tosoh-support-portal>

{% endif %}
